<!DOCTYPE html>
<html>
<head>
    <title>Bataan MaiMai Queue</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        #adminControls {
            display: none;
            margin-top: 20px;
        }
        #currentPlayers {
            margin-top: 20px;
        }
    </style>
</head>
<body>

    <h1>Bataan MaiMai Queue Management</h1>

    <!-- Admin Login Modal -->
    <div id="adminLoginModal">
        <h2>Admin Login</h2>
        <input type="password" id="adminPassword" placeholder="Enter Admin Password">
        <button onclick="checkAdmin()">Login</button>
        <p id="loginError" style="color:red; display:none;">Incorrect Password!</p>
    </div>

    <!-- Admin Controls (Hidden by Default) -->
    <div id="adminControls">
        <h2>Admin Controls</h2>
        
        <!-- Add Player -->
        <input type="text" id="playerName" placeholder="Enter Player Name">
        <button onclick="addPlayer()">Add Player</button>

        <!-- Delete Player by Position -->
        <input type="number" id="positionToDelete" placeholder="Position to Delete">
        <button onclick="deletePlayerByPosition()">Delete Player</button>

        <!-- Swap Players -->
        <button onclick="swapPlayers()">Swap First Two Players</button>

        <!-- Show Current Players -->
        <button onclick="showCurrentPlayers()">Show Current Players</button>
        <div id="currentPlayers"></div>

        <!-- Mark Player as Paid -->
        <input type="checkbox" id="markPaidCheckbox"> Mark First Player as Paid
        <button onclick="markPlayerAsPaid()">Update Payment Status</button>

        <h3>Queue:</h3>
        <ul id="queue"></ul>
    </div>

    <script>
        let queue = JSON.parse(localStorage.getItem('queue')) || [];
        let isAdmin = false;

        // Load admin status from localStorage
        if (localStorage.getItem('isAdmin') === 'true') {
            isAdmin = true;
            showAdminControls();
        }

        // Check Admin Password
        function checkAdmin() {
            const password = document.getElementById('adminPassword').value;
            if (password === 'maimaibataan') {
                isAdmin = true;
                localStorage.setItem('isAdmin', 'true');
                showAdminControls();
            } else {
                document.getElementById('loginError').style.display = 'block';
            }
        }

        // Show Admin Controls
        function showAdminControls() {
            document.getElementById('adminLoginModal').style.display = 'none';
            document.getElementById('adminControls').style.display = 'block';
            updateQueueDisplay();
        }

        // Add Player
        function addPlayer() {
            const playerName = document.getElementById('playerName').value;
            if (playerName) {
                queue.push({ name: playerName, paid: false });
                updateQueue();
            }
        }

        // Delete Player by Position
        function deletePlayerByPosition() {
            const position = parseInt(document.getElementById('positionToDelete').value) - 1;
            if (position >= 0 && position < queue.length) {
                queue.splice(position, 1);
                updateQueue();
            } else {
                alert('Invalid Position');
            }
        }

        // Swap First Two Players
        function swapPlayers() {
            if (queue.length >= 2) {
                [queue[0], queue[1]] = [queue[1], queue[0]];
                updateQueue();
            }
        }

        // Show Current Players
        function showCurrentPlayers() {
            if (queue.length === 0) {
                document.getElementById('currentPlayers').innerHTML = 'No players in queue.';
            } else {
                let display = queue
                    .slice(0, 2)
                    .map((player, index) => `${index + 1}. ${player.name} ${player.paid ? '[PAID]' : ''}`)
                    .join('<br>');
                document.getElementById('currentPlayers').innerHTML = display || 'No players to display.';
            }
        }

        // Mark Player as Paid
        function markPlayerAsPaid() {
            if (queue.length > 0) {
                queue[0].paid = document.getElementById('markPaidCheckbox').checked;
                updateQueue();
            } else {
                alert('No players in queue to mark as paid.');
            }
        }

        // Update Queue and Save to LocalStorage
        function updateQueue() {
            localStorage.setItem('queue', JSON.stringify(queue));
            updateQueueDisplay();
        }

        // Update Queue Display
        function updateQueueDisplay() {
            const queueList = document.getElementById('queue');
            queueList.innerHTML = '';
            queue.forEach((player, index) => {
                const li = document.createElement('li');
                li.innerHTML = `${index + 1}. ${player.name} ${player.paid ? '[PAID]' : ''}`;
                queueList.appendChild(li);
            });
        }

        // Listen for LocalStorage Changes Across Tabs
        window.addEventListener('storage', (event) => {
            if (event.key === 'queue') {
                queue = JSON.parse(event.newValue);
                updateQueueDisplay();
            }
        });

        // Load and Display Queue on Initial Load
        updateQueueDisplay();
    </script>
</body>
</html>
